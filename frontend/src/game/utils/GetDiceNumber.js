import * as THREE from "three"
import throwDice from "./ThrowDices"

/**
 * --> This method is a hot mess. That's what this is. But it works!! I had to do a lot of pattern recognision and a lot of math to get this to work. Probably the hardest function to build in this entire project.
 * This will get the current number on the dice that's pointing up, using the dice's rotation.
 * @param {*} dice Referecne to the dice we want the number of
 * @returns The number on the dice that's pointing up
 */
const getDiceNumber = (dice) => {
  const euler = new THREE.Euler()
  euler.setFromQuaternion(dice.rotation())

  const x = euler.x
  const y = euler.y
  const z = euler.z

  if (Math.round(Math.sin(x)) === 0 && Math.round(Math.sin(z)) === 0) {
    if (Math.round(Math.cos(x)) === Math.round(Math.cos(z))) {
      return 1
    }
    return 6
  } else if (
    Math.round(Math.sin(x)) === 0 &&
    (Math.abs(Math.PI / 2 - z) < 0.2 || Math.PI / 2 + z < 0.2)
  ) {
    if (
      (Math.abs(Math.PI - x) < 0.2 && Math.abs(Math.PI / 2 - z) < 0.2) ||
      (Math.round(x) === 0 && Math.abs(-Math.PI / 2 - z) < 0.2)
    ) {
      return 2
    }
    return 5
  } else if (
    (Math.abs(Math.PI / 2 - x) < 0.2 || Math.PI / 2 + x < 0.2) &&
    Math.round(y) === 0
  ) {
    if (Math.abs(-Math.PI / 2 - x) < 0.2 && Math.round(y) === 0) {
      return 3
    }
    return 4
  } else {
    console.log("uhhhhhhhhhh")
    throwDice([dice])
  }

  // Some dice examples of the rotation of the dice, when it's leeping
  // 1:
  // _x: 3.1256305108327114, _y: -1.5100878856031257, _z: 3.125425625711317
  // _x: 0.0015918107667124964, _y: 0.9168181096386551, _z: -0.0014976553076640048
  // _x: 3.13804536278938, _y: 1.2943213940467202, _z: -3.138414345918242
  // _x: 3.12742003833601, _y: 1.5024147409600717, _z: -3.1276875251313054

  // 6:
  // _x: 3.140433369281573, _y: 0.3143679093589594, _z: 0.0006222094766355095
  // _x: 0.0011179750282526919, _y: 0.16692008339263928, _z: -3.1415144481399584
  // _x: 3.1353754603318778, _y: -1.392534909366675, _z: -0.005855192785914245

  // 2:
  // _x: 3.1403126538063306, _y: 0.5320433465144419, _z: 1.5711823081418979
  // _x: 3.1404660421625574, _y: 0.20427773506826932, _z: 1.5707617934648705
  // _x: 3.140486805853115, _y: -0.06674640218556249, _z: 1.5704594270892702
  // _x: 0.0013081795188059772, _y: -0.567392941764316, _z: -1.5703564510510226
  // _x: 0.0017853684741958307, _y: -0.9048315317342623, _z: -1.5696554910671952
  // _x: 3.140484184061273, _y: 0.09948869613606177, _z: 1.5706431331915094
  // _x: 0.0011051515743079237, _y: -0.05958328548483913, _z: -1.570993595813825
  // _x: 0.0017257501292551579, _y: -0.8772986271071589, _z: -1.5697319242888867
  // _x: 3.1404301988223713, _y: -0.320732062342795, _z: 1.5701664825955897
  // _x: 3.1404847398618454, _y: -0.09350602269198391, _z: 1.570430075477538
  // _x: 0.18727401917531472, _y: -1.5648715445307704, _z: -1.3837890503153107

  // 5:
  // _x: 3.035690283587604, _y: 1.560705808182779, _z: -1.464636251655983
  // _x: 3.1326444980894523, _y: 1.4512781459940003, _z: -1.5616445013681182
  // _x: 0.0011925065480864535, _y: -0.4628331346421611, _z: 1.5715953678039059
  // _x: 0.0015407456448840993, _y: -0.8060041320060982, _z: 1.5721749263779945
  // _x: 3.140400603183835, _y: 0.46221764034465446, _z: -1.5699978227551388
  // _x: 0.0039044432202154796, _y: -1.2939909322650116, _z: 1.574818577563266
  // _x: 3.1403858946464465, _y: 0.4866102233780405, _z: -1.569965077086509
  // _x: 0.002095713199950449, _y: 1.036589758452318, _z: 1.5692592143572257

  // 3:
  // _x: -1.571931367850722, _y: 0.0001881356373814687, _z: 1.1767776045592004
  // _x: -1.5716724725046405, _y: -0.0007456993262120733, _z: 2.0462615833361797
  // _x: -1.5719437230744329, _y: 0.00008720360630970496, _z: 1.2655988224796977
  // _x: -1.5705021247792643, _y: -0.0011126348541532045, _z: -3.1129098026717217
  // _x: -1.5679237868561406, _y: -0.00046223189308869757, _z: 2.413183694896209
  // _x: -1.5714386432430838, _y: -0.0009548092019306174, _z: 2.3199923817585955
  // _x: -1.5696617859849085, _y: -0.00019346335782689835, _z: -1.9692813684483448
  // _x: -1.5697232385875557, _y: 0.0004148691918602225, _z: -1.431315561714728

  // 4:
  // _x: 1.5704485392704945, _y: -0.0010548007623856653, _z: -0.5604116875573528
  // _x: 1.5699358580507827, _y: 0.0007026587804618466, _z: -2.497997867938556
  // _x: 1.5704696590969753, _y: 0.0010615663990524216, _z: -3.084984119105789
  // _x: 1.5713303634432196, _y: 0.0009733864302914862, _z: 2.397477015782778
  // _x: 1.571480189229249, _y: -0.0008750758125155607, _z: 0.42114216012832184
}

export default getDiceNumber
